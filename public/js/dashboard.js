(()=>{"use strict";function t(){$('[data-toggle="ajax-modal"]').unbind("click").click((function(e){return e.preventDefault(),t=$(this),$.ajax({url:$(this).data("url")}).done((function(e,n,i){if(e){var a={},o=$(t).data("target"),d=$(t).data("backdrop");d&&(a.backdrop=d),$(o).find(".modal-content").html(e),$(o).modal(a)}})).fail((function(t,e,n){})),!1}))}var e,n,i,a,o=new IntersectionObserver((function(e){e.forEach((function(n){var i;n.isIntersecting&&(i=e[0].target,i=$(i),$.ajax({url:i.data("url")}).done((function(e){i.find(".widget-loading").hide(),i.find(".widget-body").html(e).show(),$('[data-toggle="tooltip"]').tooltip(),window.ajaxTooltip(),t(),s()})))}))}),{threshold:[0]});function d(){$(".recent-entity-type").change((function(t){this.value?$(".recent-filters").show():$(".recent-filters").hide()}))}function l(){$(".widget-recent-more").click((function(t){t.preventDefault(),$(this).find(".spinner").show(),$(this).find("span").hide(),$.ajax({url:$(this).data("url"),context:this}).done((function(t){$(this).closest(".widget-recent-list").append(t),$(this).remove(),l(),window.ajaxTooltip()}))}))}function s(){$(".widget-calendar-switch").click((function(t){t.preventDefault();var e=$(this).data("url"),n=$(this).data("widget");$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$("#widget-body-"+n).find(".widget-body").hide(),$("#widget-body-"+n).find(".widget-loading").show(),$.ajax({url:e,method:"POST",context:this}).done((function(t){if(t){var e=$(this).data("widget");$("#widget-body-"+e).find(".widget-loading").hide(),$("#widget-body-"+e).find(".widget-body").html(t).show(),$('[data-toggle="tooltip"]').tooltip(),window.ajaxTooltip(),s()}}))}))}$(document).ready((function(){$(".widget-render").length>0&&document.querySelectorAll(".widget-render").forEach((function(t){t&&o.observe(t)})),$(".preview-switch").click((function(t){t.preventDefault();var e=$("#widget-preview-body-"+$(this).data("widget"));e.hasClass("preview")?(e.removeClass("preview").addClass("full"),$(this).html('<i class="fa-solid fa-chevron-up"></i>')):(e.removeClass("full").addClass("preview"),$(this).html('<i class="fa-solid fa-chevron-down"></i>'))})),$('[data-release="remove"]').click((function(){$.post({url:$(this).data("url"),method:"POST",context:this}).done((function(t){$(this).closest(".box").fadeOut("normal",(function(t){$(this).remove(),0===$(".dashboard-releases .box").length&&$(".dashboard-releases").remove()}))}))})),$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),1===$(".campaign-dashboard-widgets").length&&($("#new-widget"),$("#new-widget-preview"),$("#new-widget-calendar"),$("#new-widget-recent"),e=$("#btn-add-widget"),n=$("#modal-content-buttons"),i=$("#modal-content-target"),a=$("#modal-content-spinner"),$(".entity-creator > a").click((function(t){var e;e=$(this).data("url"),$("#edit-widget .modal-content").html(""),n.hide(),a.show(),$.ajax(e).done((function(t){a.hide(),i.html(t),window.initForeignSelect(),window.initTags(),d()}))})),e.click((function(t){a.hide(),i.html(""),n.show()})),$("#widgets").sortable({items:".widget-draggable",stop:function(t,e){$.post({url:$("#widgets").data("url"),dataType:"json",data:$('input[name="widgets[]"]').serialize()}).done((function(t){}))}}),$(document).on("shown.bs.modal shown.bs.popover",(function(){$("#summernote-config").length>0&&window.initSummernote(),$.each($(".img-delete"),(function(){$(this).click((function(t){t.preventDefault(),$("input[name="+$(this).data("target")+"]")[0].value=1,$(this).parent().parent().hide()}))})),d()}))),l(),s(),function(){var t=$("#campaign-follow"),e=$("#campaign-follow-text");if(1!==t.length)return;t.data("following")?e.html(t.data("unfollow")):e.html(t.data("follow"));t.show(),t.click((function(n){n.preventDefault(),$.post({url:$(this).data("url"),method:"POST"}).done((function(n){n.following?e.html(t.data("unfollow")):e.html(t.data("follow"))}))}))}(),$.each($('[data-toggle="preview"]'),(function(t){$(this).height()===parseInt($(this).css("max-height"))?$(this).next().removeClass("hidden"):$(this).removeClass("pinned-entity preview")}))}))})();